<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Add node-authorization pallet · Substrate Developer Hub</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## About `node-authorization` pallet"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Add node-authorization pallet · Substrate Developer Hub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="## About `node-authorization` pallet"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script type="text/javascript" src="/js/load.js"></script><script type="text/javascript" src="/js/redirect-next.js"></script><script type="text/javascript" src="/js/config.js" defer=""></script><script type="text/javascript" src="/js/klaro.min.js" defer=""></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub"/><h2 class="headerTitleWithLogo">Substrate Developer Hub</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/en/tutorials" target="_self">Tutorials</a></li><li class=""><a href="/docs/en/" target="_self">Knowledge Base</a></li><li class=""><a href="https://substrate.dev/recipes/" target="_self">Recipes</a></li><li class=""><a href="https://substrate.dev/rustdocs/" target="_self">API Reference</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/zh-CN/tutorials/build-permission-network/add-node-authorization-pallet">简体中文</a></li><li><a href="https://crowdin.com/project/substrate-developer-hub" target="_blank" rel="noreferrer noopener">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Build a permissioned network</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Build a permissioned network<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/en/tutorials/build-permission-network/">Introduction</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/en/tutorials/build-permission-network/add-node-authorization-pallet">Add node-authorization pallet</a></li><li class="navListItem"><a class="navItem" href="/docs/en/tutorials/build-permission-network/launch-network">Launch our permissioned network</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/tetcore/substrate-developer-hub.github.io/edit/source/docs/tutorials/build-permission-network/add-node-authorization-pallet.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Add node-authorization pallet</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="about-node-authorization-pallet"></a><a href="#about-node-authorization-pallet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About <code>node-authorization</code> pallet</h2>
<p>The <code>node-authorization</code> pallet is a build-in pallet in Substrate FRAME, which manages
a configurable set of nodes for a permissioned network.
Each node is identified by a <code>PeerId</code> which is simply a wrapper on <code>Vec&lt;u8&gt;</code>.
Each <code>PeerId</code> is owned by an <code>AccountId</code> that claims it
(these are <a href="https://substrate.dev/rustdocs/v2.0.0/pallet_node_authorization/struct.Owners.html">associated in a map</a>).
With this pallet, you have two ways to authorize a node which wants to join the network:</p>
<ol>
<li>Join the set of well known nodes between which the connections are allowed.
Such effort usually needs to be approved by the governance in the system.</li>
<li>Ask for the connection from a node which is already a member of the network.
Such node can either be a well known node or a normal one.</li>
</ol>
<p>A node associated with a <code>PeerId</code> must have <strong>one and only one owner</strong>.
The owner of a well known node is specified when adding it.
If it's a normal node, <em>any</em> user can claim a <code>PeerId</code> as its owner.
To protect against false claims, the maintainer of the node should claim it <em>before even starting the node</em>
(after getting the <code>PeerId</code> of course).</p>
<p>The owner can then change the additional connections for his (or her) node.
To make it clear, you can't change the connections between well known nodes,
they are always allowed to connect with each other.
Instead, you can manipulate the connection between a well know node
and a normal node or between two normal nodes.</p>
<p>It uses <a href="https://substrate.dev/docs/en/knowledgebase/runtime/off-chain-workers">offchain worker</a>
to set authorized nodes in node-authorization pallet. Make sure to enable offchain worker with
the right CLI flag as offchain worker is diabled by default for non-authority nodes.
Your node can be lagged with the latest block, in this case you need to disable offchain worker
and manually set reachable reserved nodes to sync up with the network.</p>
<h2><a class="anchor" aria-hidden="true" id="add-the-node-authorization-pallet"></a><a href="#add-the-node-authorization-pallet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add the <code>node-authorization</code> pallet</h2>
<p>If you already hace Node Template cloned, you can just create a
<strong>new branch and check it out</strong> from the base template,
otherwise, clone <code>v2.0.0</code> of the project:</p>
<pre><code class="hljs css language-shell"><span class="hljs-meta">#</span><span class="bash"> Fresh <span class="hljs-built_in">clone</span>, <span class="hljs-keyword">if</span> needed:</span>
git clone -b v2.0.0 --depth 1 https://github.com/tetcore/substrate-node-template
<span class="hljs-meta">#</span><span class="bash"> From the working directory, create a new branch and check it out</span>
cd substrate-node-template
git branch perm-network
git checkout perm-network
</code></pre>
<p>You should be able to <code>check</code> the project (or <code>build</code>) without any error:</p>
<pre><code class="hljs css language-shell">cd substrate-node-template/
make init
make check
</code></pre>
<blockquote>
<p>If you do run into issues building, checkout
<a href="https://substrate.dev/docs/en/knowledgebase/getting-started/#rust-developer-environment">these helpful tips</a></p>
</blockquote>
<p>Now open the code with your favorite editor, can't wait to make some changes right?</p>
<p>In <strong>runtime/Cargo.toml</strong>, add the dependency of our pallet:</p>
<p><strong><code>runtime/Cargo.toml</code></strong></p>
<pre><code class="hljs css language-TOML"><span class="hljs-section">[dependencies]</span>
<span class="hljs-comment">#--snip--</span>
<span class="hljs-attr">pallet-node-authorization</span> = { default-features = <span class="hljs-literal">false</span>, version = <span class="hljs-string">'2.0.0'</span> }

<span class="hljs-comment">#--snip--</span>
<span class="hljs-section">[features]</span>
<span class="hljs-attr">default</span> = [<span class="hljs-string">'std'</span>]
<span class="hljs-attr">std</span> = [
    <span class="hljs-comment">#--snip--</span>
    pallet-node-authorization/std,
    <span class="hljs-comment">#--snip--</span>
]
</code></pre>
<p>Let's import and use our pallet in <strong>runtime/src/lib.rs</strong>. Firstly Import the dependency
with <code>use frame_system::EnsureRoot</code>, we need it to simulate the governance in our simple blockchain.
Then implement the configure trait of our pallet. More description on the trait can be found in
its <a href="https://docs.rs/pallet-node-authorization/2.0.0/pallet_node_authorization/trait.Trait.html">reference doc</a>.</p>
<p><strong><code>runtime/src/lib.rs</code></strong></p>
<pre><code class="hljs css language-rust">
<span class="token comment">/* --snip-- */</span>

<span class="token keyword">use</span> <span class="token namespace">frame_system<span class="token punctuation">::</span></span><span class="token class-name">EnsureRoot</span>

<span class="token comment">/* --snip-- */</span>

<span class="token macro property">parameter_types!</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">const</span> <span class="token class-name">MaxWellKnownNodes</span><span class="token punctuation">:</span> <span class="token keyword">u32</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token keyword">pub</span> <span class="token keyword">const</span> <span class="token class-name">MaxPeerIdLength</span><span class="token punctuation">:</span> <span class="token keyword">u32</span> <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">pallet_node_authorization<span class="token punctuation">::</span></span><span class="token class-name">Trait</span> <span class="token keyword">for</span> <span class="token class-name">Runtime</span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> <span class="token class-name">Event</span> <span class="token operator">=</span> <span class="token class-name">Event</span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">MaxWellKnownNodes</span> <span class="token operator">=</span> <span class="token class-name">MaxWellKnownNodes</span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">MaxPeerIdLength</span> <span class="token operator">=</span> <span class="token class-name">MaxPeerIdLength</span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">AddOrigin</span> <span class="token operator">=</span> <span class="token class-name">EnsureRoot</span><span class="token operator">&lt;</span><span class="token class-name">AccountId</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">RemoveOrigin</span> <span class="token operator">=</span> <span class="token class-name">EnsureRoot</span><span class="token operator">&lt;</span><span class="token class-name">AccountId</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">SwapOrigin</span> <span class="token operator">=</span> <span class="token class-name">EnsureRoot</span><span class="token operator">&lt;</span><span class="token class-name">AccountId</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">ResetOrigin</span> <span class="token operator">=</span> <span class="token class-name">EnsureRoot</span><span class="token operator">&lt;</span><span class="token class-name">AccountId</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token keyword">type</span> <span class="token class-name">WeightInfo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* --snip-- */</span>
</code></pre>
<p>Finally, we are ready to put our pallet in <code>construct_runtime</code> macro with following extra line of code:</p>
<p><strong><code>runtime/src/lib.rs</code></strong></p>
<pre><code class="hljs css language-rust"><span class="token macro property">construct_runtime!</span><span class="token punctuation">(</span>
    <span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">Runtime</span> <span class="token keyword">where</span>
        <span class="token class-name">Block</span> <span class="token operator">=</span> <span class="token class-name">Block</span><span class="token punctuation">,</span>
        <span class="token class-name">NodeBlock</span> <span class="token operator">=</span> <span class="token namespace">opaque<span class="token punctuation">::</span></span><span class="token class-name">Block</span><span class="token punctuation">,</span>
        <span class="token class-name">UncheckedExtrinsic</span> <span class="token operator">=</span> <span class="token class-name">UncheckedExtrinsic</span>
    <span class="token punctuation">{</span>
        <span class="token comment">/* --snip-- */</span>

        <span class="token comment">/*** Add This Line ***/</span>
        <span class="token class-name">NodeAuthorization</span><span class="token punctuation">:</span> <span class="token namespace">pallet_node_authorization<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Module</span><span class="token punctuation">,</span> <span class="token class-name">Call</span><span class="token punctuation">,</span> <span class="token class-name">Storage</span><span class="token punctuation">,</span> <span class="token class-name">Event</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token class-name">Config</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">></span><span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token comment">/* --snip-- */</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="add-genesis-storage-for-our-pallet"></a><a href="#add-genesis-storage-for-our-pallet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Add genesis storage for our pallet</h2>
<p><code>PeerId</code> is encoded in bs58 format, so we need a new library
<a href="https://docs.rs/bs58/0.3.1/bs58/">bs58</a> in <strong>node/cargo.toml</strong> to decode it to get its bytes.</p>
<p><strong><code>node/cargo.toml</code></strong></p>
<pre><code class="hljs css language-TOML"><span class="hljs-section">[dependencies]</span>
<span class="hljs-comment">#--snip--</span>
<span class="hljs-attr">bs58</span> = <span class="hljs-string">"0.3.1"</span>
<span class="hljs-comment">#--snip--</span>
</code></pre>
<p>Now we add a proper genesis storage in <strong>node/src/chain_spec.rs</strong>. Similarly, import the necessary dependencies:</p>
<p><strong>node/src/chain_spec.rs</strong></p>
<pre><code class="hljs css language-rust"><span class="token comment">/* --snip-- */</span>
<span class="token keyword">use</span> <span class="token namespace">sp_core<span class="token punctuation">::</span></span><span class="token class-name">OpaquePeerId</span><span class="token punctuation">;</span> <span class="token comment">// A struct wraps Vec&lt;u8>, represents as our `PeerId`.</span>
<span class="token keyword">use</span> <span class="token namespace">node_template_runtime<span class="token punctuation">::</span></span><span class="token class-name">NodeAuthorizationConfig</span><span class="token punctuation">;</span> <span class="token comment">// The genesis config that serves for our pallet.</span>
<span class="token comment">/* --snip-- */</span>
</code></pre>
<p>Adding our genesis config in the helper function <code>testnet_genesis</code>,</p>
<pre><code class="hljs css language-rust"><span class="token comment">/// Configure initial storage state for FRAME modules.</span>
<span class="token keyword">fn</span> <span class="token function-definition function">testnet_genesis</span><span class="token punctuation">(</span>
    wasm_binary<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    initial_authorities<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token class-name">AuraId</span><span class="token punctuation">,</span> <span class="token class-name">GrandpaId</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">,</span>
    root_key<span class="token punctuation">:</span> <span class="token class-name">AccountId</span><span class="token punctuation">,</span>
    endowed_accounts<span class="token punctuation">:</span> <span class="token class-name">Vec</span><span class="token operator">&lt;</span><span class="token class-name">AccountId</span><span class="token operator">></span><span class="token punctuation">,</span>
    _enable_println<span class="token punctuation">:</span> <span class="token keyword">bool</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">GenesisConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">/* --snip-- */</span>

    <span class="token comment">/*** Add This Block Item ***/</span>
    pallet_node_authorization<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">NodeAuthorizationConfig</span> <span class="token punctuation">{</span>
        nodes<span class="token punctuation">:</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
            <span class="token punctuation">(</span>
                <span class="token class-name">OpaquePeerId</span><span class="token punctuation">(</span><span class="token namespace">bs58<span class="token punctuation">::</span></span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">"12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into_vec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                endowed_accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">(</span>
                <span class="token class-name">OpaquePeerId</span><span class="token punctuation">(</span><span class="token namespace">bs58<span class="token punctuation">::</span></span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">"12D3KooWQYV9dGMFoRzNStwpXztXaBUjtPqi6aU76ZgUriHhKust"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into_vec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                endowed_accounts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token comment">/* --snip-- */</span>

<span class="token punctuation">}</span>
</code></pre>
<p><code>NodeAuthorizationConfig</code> contains a property named <code>nodes</code>, which is vector of tuple.
The first element of the tuple is the <code>OpaquePeerId</code> and we use <code>bs58::decode</code> to convert
the <code>PeerId</code> in human readable format to bytes. The second element of the tuple is <code>AccountId</code>
and represents the owner of this node, here we are using one of the provided endowned accounts
for demonstration. To make it clear, the owner of the first node is Alice, and Bob owns the second node.</p>
<p>You may wondering where the <code>12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2</code> comes from.
We can use <a href="https://substrate.dev/docs/en/knowledgebase/integrate/subkey#generating-node-keys">subkey</a> to generate the above human readable <code>PeerId</code>.</p>
<pre><code class="hljs css language-shell">subkey generate-node-key
</code></pre>
<blockquote>
<p>Note: <code>subkey</code> is a CLI tool that comes bundled with substrate, and you can install it natively too!</p>
<ul>
<li><a href="https://substrate.dev/docs/en/knowledgebase/integrate/subkey#installation">Install Intructions</a></li>
</ul>
</blockquote>
<p>The output of the command is like:</p>
<pre><code class="hljs css language-shell">12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2 // this is PeerId.
c12b6d18942f5ee8528c8e2baf4e147b5c5c18710926ea492d09cbd9f6c9f82a // This is node-key.
</code></pre>
<p>Now all the code changes are finished, we are ready to launch our permissoned network. Go get yourself some water!</p>
<blockquote>
<p>Stuck? The solution with all required changes to the base template can be found <a href="https://github.com/kaichaosun/substrate-permission-network/commit/c8b8f610afaab024c16da0917d059dc5050d3807">here</a>.</p>
</blockquote>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 1/16/2021 by Dan Shields</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/en/tutorials/build-permission-network/index"><span class="arrow-prev">← </span><span>Introduction</span></a><a class="docs-next button" href="/docs/en/tutorials/build-permission-network/launch-network"><span>Launch our permissioned network</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#about-node-authorization-pallet">About <code>node-authorization</code> pallet</a></li><li><a href="#add-the-node-authorization-pallet">Add the <code>node-authorization</code> pallet</a></li><li><a href="#add-genesis-storage-for-our-pallet">Add genesis storage for our pallet</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub" width="66" height="58"/></a><div><h5>Developer Hub</h5><a href="/en/tutorials">Tutorials</a><a href="/docs/en/">Knowledge Base</a><a href="https://substrate.dev/recipes/">Recipes</a><a href="https://substrate.dev/rustdocs">API Reference</a></div><div><h5>Community</h5><a href="/en/community">Community Home</a><a href="/en/newsletter">Newsletter</a><a href="https://app.element.io/#/room/!HzySYSaIhtyWrwiwEV:matrix.org">Substrate Technical Chat</a><a href="/en/seminar">Substrate Seminar</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/ParityTech" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.meetup.com/parity/" target="_blank" rel="noreferrer noopener">Events</a></div><div><h5>More</h5><a href="https://www.substrate.io/builders-program/">Substrate Builders Program</a><a href="https://www.parity.io/blog/">Blog</a><a href="https://github.com/tetcoin/tetcore">Substrate GitHub</a><a href="https://github.com/tetcore/">Developer Hub GitHub</a><a href="https://www.parity.io/privacy/">Privacy Policy</a><a href="/terms">Terms of Use</a><a href="#" id="cookie-settings">Cookie Settings<script>
                var cookieSettings = document.getElementById('cookie-settings');
                cookieSettings.onclick = function() {
                  return klaro.show();
                };
              </script></a></div></section><section class="copyright">Copyright © 2021 Parity Technologies</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '5cd09916f4ba4c283b2d45ee7386fc34',
                indexName: 'substrate',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:en"]}
              });
            </script></body></html>